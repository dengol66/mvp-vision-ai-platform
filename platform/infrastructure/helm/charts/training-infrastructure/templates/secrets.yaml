{{- if .Values.s3.enabled }}
# S3/MinIO credentials secret
# In production, use external secret management (e.g., External Secrets Operator)
# This template creates a placeholder secret that should be populated via:
#   - helm install --set-file or
#   - kubectl create secret (before helm install with s3.secretName reference)
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Values.s3.secretName }}
  namespace: {{ include "training-infrastructure.namespace" . }}
  labels:
    {{- include "training-infrastructure.labels" . | nindent 4 }}
  annotations:
    helm.sh/resource-policy: keep
type: Opaque
stringData:
  # Placeholder values - override during installation
  # helm install ... --set-string s3.accessKey=xxx --set-string s3.secretKey=xxx
  access-key: {{ .Values.s3.accessKey | default "CHANGE_ME" | quote }}
  secret-key: {{ .Values.s3.secretKey | default "CHANGE_ME" | quote }}
  {{- if .Values.s3.endpoint }}
  endpoint: {{ .Values.s3.endpoint | quote }}
  {{- end }}
  {{- if .Values.s3.bucket }}
  bucket: {{ .Values.s3.bucket | quote }}
  {{- end }}
{{- end }}
